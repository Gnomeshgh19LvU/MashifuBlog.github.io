<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>马师傅的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="马师傅的博客">
<meta property="og:url" content="https://gnomeshgh19lvu.github.io/MashifuBlog.github.io/index.html">
<meta property="og:site_name" content="马师傅的博客">
<meta property="og:locale" content="zn_CN">
<meta property="article:author" content="马师傅">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/MashifuBlog.github.io/atom.xml" title="马师傅的博客" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/MashifuBlog.github.io/favicon.png">
  
  
  
<link rel="stylesheet" href="/MashifuBlog.github.io/css/style.css">

  
    
<link rel="stylesheet" href="/MashifuBlog.github.io/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.1.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/MashifuBlog.github.io/" id="logo">马师傅的博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/MashifuBlog.github.io/">Home</a>
        
          <a class="main-nav-link" href="/MashifuBlog.github.io/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/MashifuBlog.github.io/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Suche"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Suche"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://gnomeshgh19lvu.github.io/MashifuBlog.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-马师傅的博客" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/MashifuBlog.github.io/2024/03/05/%E9%A9%AC%E5%B8%88%E5%82%85%E7%9A%84%E5%8D%9A%E5%AE%A2/" class="article-date">
  <time class="dt-published" datetime="2024-03-05T13:00:53.000Z" itemprop="datePublished">2024-03-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/MashifuBlog.github.io/2024/03/05/%E9%A9%AC%E5%B8%88%E5%82%85%E7%9A%84%E5%8D%9A%E5%AE%A2/">马师傅的博客</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="一-使用阿里云短信服务调用接口完成短信验证码功能"><a href="#一-使用阿里云短信服务调用接口完成短信验证码功能" class="headerlink" title="一.使用阿里云短信服务调用接口完成短信验证码功能"></a>一.使用阿里云短信服务调用接口完成短信验证码功能</h2><h3 id="1-获取秘钥"><a href="#1-获取秘钥" class="headerlink" title="1.获取秘钥"></a>1.获取秘钥</h3><p>accessKeyId，</p>
<p>accessKeySecret，</p>
<p>SignName，(短信模板)</p>
<p>TemplateCode，(短信签名名称)</p>
<h4 id="1-1获取accessKeyId，accessKeySecret"><a href="#1-1获取accessKeyId，accessKeySecret" class="headerlink" title="1.1获取accessKeyId，accessKeySecret"></a>1.1获取accessKeyId，accessKeySecret</h4><p>accessKeyId，accessKeySecret可以直接获取  </p>
<p>  <img src="https://img2.imgtp.com/2024/03/10/rNC1OBvE.png" alt="ali-1">  </p>
<p>点击AccessKey然后无脑确认即可获取AccessKey  </p>
<p><img src="https://img2.imgtp.com/2024/03/10/SmDdGJhs.png" alt="ali-2">  </p>
<p><strong>Ps:创建一个即可，暂时不需要这么多，并且请保存好自己的AccessKey</strong></p>
<h4 id="1-2获取SignName，TemplateCode"><a href="#1-2获取SignName，TemplateCode" class="headerlink" title="1.2获取SignName，TemplateCode"></a>1.2获取SignName，TemplateCode</h4><p>访问ali的工作台，搜索短信服务或者直接输入sms</p>
<p><strong>点击国内消息完成1.资质管理，2.签名管理，3.模板管理</strong></p>
<p><img src="https://img2.imgtp.com/2024/03/10/WddqObA3.png" alt="ali-3"></p>
<p><img src="https://img2.imgtp.com/2024/03/10/4vwwxJGh.png" alt="ali-4"></p>
<p><img src="https://img2.imgtp.com/2024/03/10/s1KpmciE.png" alt="ali-5"></p>
<p>Ps:在添加签名的时候建议不要和我一样用线上测试，可以用测试或学习，可以获得1000条免费短信的数量，好像是三个月吧。应用场景和场景说明最好填写一些努力学习的字眼，但是千万不要提到<strong>测试</strong></p>
<h3 id="2-完成测试并获取源码"><a href="#2-完成测试并获取源码" class="headerlink" title="2.完成测试并获取源码"></a>2.完成测试并获取源码</h3><h4 id="2-1完成API测试"><a href="#2-1完成API测试" class="headerlink" title="2.1完成API测试"></a>2.1完成API测试</h4><p>回到快速学习与测试<strong>通过API发送短信</strong>绑定测试手机号并写入相应的签名和模板完成测试</p>
<h4 id="2-2获取源码"><a href="#2-2获取源码" class="headerlink" title="2.2获取源码"></a>2.2获取源码</h4><p>点击概览，找到Open AI开发者门户，在上方找到SDK选择语言为java，右侧有SDK信息，可以获取相应的Maven依赖，将源码打包并部署到自己的电脑中即可</p>
<h3 id="3-创建工程，完成测试"><a href="#3-创建工程，完成测试" class="headerlink" title="3.创建工程，完成测试"></a>3.创建工程，完成测试</h3><p>因为我用的代码和ali上的源码有出入，我就以我的代码来讲了</p>
<h4 id="3-1-测试"><a href="#3-1-测试" class="headerlink" title="3.1 测试"></a>3.1 测试</h4><p>（1）我们首先先创建一个简单的Springboot项目并导入相关依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.aliyun<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dysmsapi20170525<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.8.15<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.28<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>jakarta.validation<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jakarta.validation-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>（2）创建一个Utils包并命名为AliSmsUtils，并写入代码（源码）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.Ma.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.util.RandomUtil;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.dysmsapi20170525.Client;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.dysmsapi20170525.models.SendSmsRequest;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.teaopenapi.models.Config;</span><br><span class="line"><span class="keyword">import</span> com.aliyun.teautil.models.RuntimeOptions;</span><br><span class="line"><span class="keyword">import</span> jakarta.annotation.PostConstruct;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Optional;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(&quot;sms&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AliSmsUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span>  Client client;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取你的accessKeyId</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span>  String accessKeyId;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取你的accessKeySecret</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span>  String accessKeySecret;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取你的短信模板CODE</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span>  String TemplateCode;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取你的短信签名名称</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span>  String SignName;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Config</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Config</span>()</span><br><span class="line">                .setAccessKeyId(Optional.ofNullable(accessKeyId).orElseThrow(() -&gt;</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;accessKeyId must not be null&quot;</span>)))</span><br><span class="line">                .setAccessKeySecret(Optional.ofNullable(accessKeySecret).orElseThrow(() -&gt;</span><br><span class="line">                        <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;accessKeySecret must not be null&quot;</span>)));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置请求地址</span></span><br><span class="line">        config.endpoint = <span class="string">&quot;dysmsapi.aliyuncs.com&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.client = <span class="keyword">new</span> <span class="title class_">Client</span>(config);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Failed to initialize SMS client&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> phone 手机号</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> code 验证码</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendSms</span><span class="params">(String phone, String code)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">SendSmsRequest</span> <span class="variable">sendSmsRequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SendSmsRequest</span>()</span><br><span class="line">                .setSignName(SignName)</span><br><span class="line">                .setTemplateCode(TemplateCode)</span><br><span class="line">                .setPhoneNumbers(phone)</span><br><span class="line">                .setTemplateParam(<span class="string">&quot;&#123;\&quot;code\&quot;:&quot;</span>+code+<span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">        <span class="type">RuntimeOptions</span> <span class="variable">runtime</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RuntimeOptions</span>();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 复制代码运行请自行打印 API 的返回值</span></span><br><span class="line">            client.sendSmsWithOptions(sendSmsRequest, runtime);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 返回4位随机生成的验证码</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">Random4</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">code</span> <span class="operator">=</span> RandomUtil.randomInt(<span class="number">1000</span>, <span class="number">9999</span>);</span><br><span class="line">        <span class="keyword">return</span> String.valueOf(code);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 返回6位随机生成的验证码</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">Random6</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">code</span> <span class="operator">=</span> RandomUtil.randomInt(<span class="number">100000</span>, <span class="number">999999</span>);</span><br><span class="line">        <span class="keyword">return</span> String.valueOf(code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>（3）我们还必须在application.yml中配置相关信息</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">sms:</span></span><br><span class="line">  <span class="attr">accessKeyId:</span> </span><br><span class="line">  <span class="attr">accessKeySecret:</span> </span><br><span class="line">  <span class="attr">SignName:</span> </span><br><span class="line">  <span class="attr">TemplateCode:</span> </span><br></pre></td></tr></table></figure>

<p>以上的信息是在阿里云官方弄好的产品密钥，用自己的 <strong>注意 在:之后要加一个空格才写入东西，后面的秘钥可以不用加双引号</strong></p>
<p>（4）创建测试类</p>
<p>在test包下创建AliSmsTest类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.Ma;</span><br><span class="line"><span class="keyword">import</span> com.Ma.utils.AliSmsUtils;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AliSmsTest</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AliSmsUtils sendSms;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">     <span class="keyword">void</span> <span class="title function_">send</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> sendSms.Random6();</span><br><span class="line">        System.out.println(code);</span><br><span class="line">        sendSms.sendSms(<span class="string">&quot;自己的手机号&quot;</span>, code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>冷知识，因为我们创建的是线上测试，测试与学习，手机号码只能是在2.1中绑定的自己的手机号，最多能绑定5个手机号，虽然有点少但是用于测试或学习已经够了</strong></p>
<p>然后运行就可以收到自己的手机短信验证码啦</p>
<p><img src="https://img2.imgtp.com/2024/03/10/7oMMmhAt.png" alt="ali-6"></p>
<p><img src="https://img2.imgtp.com/2024/03/10/Yqk9m8Wl.png" alt="ali-7"></p>
<h4 id="3-2-完成接口调用"><a href="#3-2-完成接口调用" class="headerlink" title="3.2 完成接口调用"></a>3.2 完成接口调用</h4><p>（1）创建controller包，创建SMSController类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.Ma.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.Ma.utils.AliSmsUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.MediaType;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.validation.Valid;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/send&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SmsController</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AliSmsUtils aliSmsUtils;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SmsController</span><span class="params">(AliSmsUtils aliSmsUtils)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.aliSmsUtils = aliSmsUtils;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(value = &quot;/send_sms&quot;, consumes = MediaType.APPLICATION_JSON_VALUE, produces = MediaType.APPLICATION_JSON_VALUE)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, String&gt; <span class="title function_">sendVerificationCode</span><span class="params">(<span class="meta">@RequestBody</span> <span class="meta">@Valid</span> SmsRequest smsRequest)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">phone</span> <span class="operator">=</span> smsRequest.getPhoneNumber();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 验证手机号码</span></span><br><span class="line">        <span class="keyword">if</span> (!isValidPhoneNumber(phone)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;手机号格式不正确&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> AliSmsUtils.Random6(); <span class="comment">// 根据需求生成验证码</span></span><br><span class="line">            aliSmsUtils.sendSms(phone, code);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 返回包含手机号和真实验证码的JSON</span></span><br><span class="line">            Map&lt;String, String&gt; response = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">            response.put(<span class="string">&quot;phone&quot;</span>, phone);</span><br><span class="line">            response.put(<span class="string">&quot;code&quot;</span>, code);</span><br><span class="line">            response.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;验证码已发送&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> response;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;发送验证码失败&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 校验手机号格式</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">isValidPhoneNumber</span><span class="params">(String phoneNumber)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">regex</span> <span class="operator">=</span> <span class="string">&quot;^1[3-9]\\d&#123;9&#125;$&quot;</span>; <span class="comment">// 中国内地手机号格式</span></span><br><span class="line">        <span class="keyword">return</span> Pattern.matches(regex, phoneNumber);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建一个新的类来表示请求体</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">SmsRequest</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String phoneNumber;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// getter 和 setter 方法</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getPhoneNumber</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> phoneNumber;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPhoneNumber</span><span class="params">(String phoneNumber)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.phoneNumber = phoneNumber;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="3-3-在postman中查收"><a href="#3-3-在postman中查收" class="headerlink" title="3.3 在postman中查收"></a>3.3 在postman中查收</h4><p>由于我们是接受短信验证码，所以我们使用post请求</p>
<p>然后我们访问的域名端口是<strong><a target="_blank" rel="noopener" href="http://localhost:8080/send/send_sms">http://localhost:8080/send/send_sms</a></strong></p>
<p>可自由更改api</p>
<p>在params中我们输入</p>
<p>key:phone</p>
<p>value:自己的手机号</p>
<p>在Headers请求头中我们新增</p>
<p>key:Content-Type</p>
<p>value:application&#x2F;json</p>
<p>在body中更改为raw，json</p>
<p>并输入json格式为</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;phoneNumber&quot;</span><span class="punctuation">:</span><span class="string">&quot;自己的手机号&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="3-4-验收"><a href="#3-4-验收" class="headerlink" title="3.4 验收"></a>3.4 验收</h4><p>回到我们的后端代码中，启动服务，<strong>温馨小提示，Springboot至少需要jdk17不然会报错</strong></p>
<p>到postman中点击send，同样可以收到短信啦</p>
<p><img src="https://img2.imgtp.com/2024/03/10/tXFlbddY.png" alt="ali-8"></p>
<p><img src="https://img2.imgtp.com/2024/03/10/gQNHBkyi.png" alt="ali-9"></p>
<p>以上就是用java调用ali的短信服务完成接受短信验证码的功能啦</p>
<p>感谢观看！~</p>
<p><strong>最后提醒，如果你调用了ali的AssessKey，上传github或者gitee的时候请不要暴露ASsessKey</strong></p>
<p>获取马师傅同款源码：<a target="_blank" rel="noopener" href="https://github.com/Gnomeshgh19LvU/AliSms">Gnomeshgh19LvU&#x2F;AliSms (github.com)</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://gnomeshgh19lvu.github.io/MashifuBlog.github.io/2024/03/05/%E9%A9%AC%E5%B8%88%E5%82%85%E7%9A%84%E5%8D%9A%E5%AE%A2/" data-id="clto1u4ta0000ksue7hrwhl3m" data-title="马师傅的博客" class="article-share-link"><span class="fa fa-share">Teilen</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/MashifuBlog.github.io/archives/2024/03/">March 2024</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">letzter Beitrag</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/MashifuBlog.github.io/2024/03/05/%E9%A9%AC%E5%B8%88%E5%82%85%E7%9A%84%E5%8D%9A%E5%AE%A2/">马师傅的博客</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 马师傅<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/MashifuBlog.github.io/" class="mobile-nav-link">Home</a>
  
    <a href="/MashifuBlog.github.io/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/MashifuBlog.github.io/js/jquery-3.6.4.min.js"></script>



  
<script src="/MashifuBlog.github.io/fancybox/jquery.fancybox.min.js"></script>




<script src="/MashifuBlog.github.io/js/script.js"></script>





  </div>
</body>
</html>